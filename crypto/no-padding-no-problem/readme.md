# No Padding, No Problem

1. For this challenge we are given an address where we have to connect
`nc mercury.picoctf.net 28517`

2. This prompt shows us the following result
```
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!

n:162603037753079028918906715513521821182925862168667358554864034482560488924764474898783315176705651338964296284580426597255177305604148058420319977041206415305918933254128774279372403348842118215231353885093887300584936380779586042568526313629115180882643950225304842131470620780504884640188257080877326889669
e: 65537
ciphertext:24337213320401229369059373227862651376977661907373808446066759065872323046039637043799552636812878682303861864250329071672449666762621324042386465947341055300124962322238233501462616073813103803687584702996577118674777067574281600001637383326857214128415988474527885892998050652996201065988893291327231024419
```

3. When we try to pass the same cipher then the prompt gives this
```
Give me ciphertext to decrypt: 44955814284937154144901303047989136688361573878062931827057975374366212340994925636430713036039501034852133068238113943365698113334300117492828114253273425147729754821059370136674832360662989495121399101599053508255656777104934669164248228406590486823736984585359474982606196613200853183734134858531715829415
Will not decrypt the ciphertext. Try Again
```

4. The challenge mentions that there is **no padding** and from the output we got from the `nc` command we can also see that they are using **RSA**.
5. From the above we can get to know that it's an **Unpadded RSA implementation**. After searching about unpadded came to know one thing that it is **homomorphic** in nature, meaning
```
encrypt(m1) * encrypt(m2) = ((m1**e) * (m2**e)) mod n = (m1 * m2)**e mod n = encrypt(m1 * m2)
```

[Risk of implementing RSA without padding](https://www.tutorialspoint.com/what-are-risks-in-implementing-the-rsa-algorithm-without-padding)

6. So now what we can do is generate a closely related ciphertext using the given values that we have and pass it to the decryption algorithm for getting our result

```
c2 = pow(3,e,n)
29117184337307572917244711032460715967608041307689551108020770266010178431884359770448127308833973931854700178166115454416531488597195861968820906969465848127325283966887425609758552597511174268801030895749708443803394220679375996671882441160223106615914063910899981205416941207729958233682018416444067613691

cipher2 = c2 * cipher
708631126506499906038882620899639259907674073369112041477539333629633662733798384229667063422610365109254464589969696533294524110735872609959830812904069294792522325279173271898123202418067403235066606867502725651734967799543077007692210651673057299959518849719637524759104327395861159100791821751060360266315050638645076068633820264198105641092655510463322824854945386144076881524276507454371328804092769264501603625323723203219248236720093099576680827781136717116966916054582659404169542137416400780187455235219344206178730002969681934497679752206933898483366572065164948980907899906815997557026047524406679720529
```

7. Now we can pass this to the nc command
```
Here you go: 63825770398048665944445964895105700283851313816501986200128897874099812469939403534980162259312951419229840326914748562621455629288711058130843889314212373469935084427226069908955021212523921080105514746004437790874477210206572917135262020600830593271851615426794824182120894907932351788589522550032438744852
```

8. We can divide this number with 3 and get the main plaintext
9. After this we just have to convert the result fromhex and then decode `bytearray.fromhex(format(main1, 'x')).decode()`
